source.dir<-"/home/ksodhi/Desktop/Summer 2017_2/SQLite Read Only/rSFSTEP2/StepWat_R_Wrapper_Parallel/"
#Load Required Packages
library(DBI)
library(RSQLite)
library(mail)
library(sendmailR)
proc_count<-6
setwd(source.dir)
db_loc<-"/home/ksodhi/Desktop/Summer 2017_2/SQLite Read Only/rSFSTEP2/StepWat_R_Wrapper_Parallel/"
database<-paste(db_loc,"dbWeatherData_Sagebrush_KP.sqlite", sep="")
#Query script (Loads data from the database into a list)
query.file<-paste(source.dir,"RSoilWat31.Weather.Data.Query_V2.R", sep="")
#Assembly script (Assemble data with respect to years and conditions)
assemble.file<-paste(source.dir,"Weather.Assembly.Choices_V2.R", sep="")
#Markov script (To generate cov and prob files)
markov.file<-paste(source.dir,"Markov.Weather_V2.R",sep="")
#Wrapper script
wrapper.file<-paste(source.dir,"StepWat.Wrapper.Code_V3.R", sep="")
#Output script
output.file<-paste(source.dir,"SoilWatOutput.R", sep="")
#Start timing for timing statistics
tick_on<-proc.time()
#rSFSTEP2 will automatically populate the site string with the sites specified in generate_stepwat_sites.sh
site<-1
species1<-c(21,80,144,150,244,291,374,409,411,542,320,384,391,413,501,592,687,733,758,761,781,787,798,816,824,828,866,868,869,876,879)
species2<-c(609,676,729,730,778,792,809,818,826,829,854,857,862)
species3<-c(163,211,221,230,264,283,341,354,365,380,387,497,524,543,566,581,608,175,178,217,319,335,369,498,595,659,4,7,14,15,23,79)
species<-"species"
################################ Weather Query Code ###################################
#Setup parameters for the weather aquisition (years, scenarios, timeperiod, GCMs)
simstartyr <- 1979
endyr <- 2010
climate.ambient <- "Current"
#Specify the RCP/GCM combinations
climate.conditions <- c(climate.ambient,  "RCP45.CanESM2", "RCP45.CESM1-CAM5", "RCP45.CSIRO-Mk3-6-0", "RCP45.FGOALS-g2", "RCP45.FGOALS-s2", "RCP45.GISS-E2-R", "RCP45.HadGEM2-CC", "RCP45.HadGEM2-ES",
"RCP45.inmcm4", "RCP45.IPSL-CM5A-MR", "RCP45.MIROC5", "RCP45.MIROC-ESM","RCP45.MRI-CGCM3", "RCP85.CanESM2", "RCP85.CESM1-CAM5", "RCP85.CSIRO-Mk3-6-0", "RCP85.FGOALS-g2","RCP85.FGOALS-s2","RCP85.GISS-E2-R","RCP85.HadGEM2-CC","RCP85.HadGEM2-ES","RCP85.inmcm4","RCP85.IPSL-CM5A-MR","RCP85.MIROC5","RCP85.MIROC-ESM","RCP85.MRI-CGCM3")
#Difference between start and end year(if you want 2030-2060 use 50; if you want 2070-2100 use 90 below)
deltaFutureToSimStart_yr <- c(50,90)
#Downscaling method
downscaling.method <- c("hybrid-delta")
#Store climate conditons
#List of all future and current scenarios putting "Current" first
temp <- climate.conditions[!grepl(climate.ambient, climate.conditions)] #make sure 'climate.ambient' is first entry
if(length(temp) > 0){
temp <- paste0(deltaFutureToSimStart_yr, "years.", rep(temp, each=length(deltaFutureToSimStart_yr)))	#add (multiple) deltaFutureToSimStart_yr
temp <- paste0(downscaling.method, ".", rep(temp, each=length(downscaling.method))) #add (multiple) downscaling.method
}
climate.conditions <-  c("Current",temp)
temp<-c("Current",temp)
sites<-1
library(plyr)
#Connecting to the database
db<-dbDriver("SQLite")
db<-dbConnect(db,database,flags = SQLITE_RO)
con.env <- NULL
con.env$con<-db
getwd(0)
getwd()
#Connecting to the database
db<-dbDriver("SQLite")
db<-dbConnect(db,database)#,flags = SQLITE_RO)
con.env <- NULL
con.env$con<-db
getwd()
database<-paste(db_loc,"dbWeatherData_Sagebrush_KP.sqlite", sep="")
db_loc<-"/home/ksodhi/Desktop/Summer 2017_2/SQLite Read Only/rSFSTEP2/StepWat_R_Wrapper_Parallel"
database<-paste(db_loc,"dbWeatherData_Sagebrush_KP.sqlite", sep="")
#Connecting to the database
db<-dbDriver("SQLite")
db<-dbConnect(db,database)#,flags = SQLITE_RO)
con.env <- NULL
con.env$con<-db
db_loc<-"/home/ksodhi/Desktop/Summer 2017_2/SQLite Read Only/rSFSTEP2/StepWat_R_Wrapper_Parallel"
database<-paste(db_loc,"dbWeatherData_Sagebrush_KP.sqlite", sep="")
#Connecting to the database
db<-dbDriver("SQLite")
db<-dbConnect(db,database,flags = SQLITE_RO)
con.env <- NULL
con.env$con<-db
